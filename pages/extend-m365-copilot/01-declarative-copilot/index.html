
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://microsoft.github.io/copilot-camp/pages/extend-m365-copilot/01-declarative-copilot/">
      
      
        <link rel="prev" href="../00-prerequisites/">
      
      
        <link rel="next" href="../02-api-plugin/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>Lab A1 - Declarative Copilot - Copilot camp</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/labStyles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="#35258F" data-md-color-accent="#091F2C">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lab-a1-customise-copilot-by-building-a-declarative-copilot" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Copilot camp" class="md-header__button md-logo" aria-label="Copilot camp" data-md-component="logo">
      
  <img src="../../../assets/images/logo-copilot-camp.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Copilot camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab A1 - Declarative Copilot
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Path A Extend Copilot

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../custom-engine/" class="md-tabs__link">
          
  
  Path B Build Your Own Copilot

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Copilot camp" class="md-nav__button md-logo" aria-label="Copilot camp" data-md-component="logo">
      
  <img src="../../../assets/images/logo-copilot-camp.jpg" alt="logo">

    </a>
    Copilot camp
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/microsoft/copilot-camp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    microsoft/copilot-camp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Path A Extend Copilot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Path A Extend Copilot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A0 - Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Lab A1 - Declarative Copilot
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Lab A1 - Declarative Copilot
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anatomy-of-the-app-package" class="md-nav__link">
    <span class="md-ellipsis">
      Anatomy of the app package
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-1-scaffold-a-declarative-copilot-from-template" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Scaffold a declarative copilot from template
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 1: Scaffold a declarative copilot from template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-software-pre-requisites" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Software Pre-Requisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-environment-pre-requisites" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Environment Pre-Requisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-use-teams-toolkit-cli-to-create-a-new-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Use Teams Toolkit CLI to create a new app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-understanding-the-files-in-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Understanding the files in the app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercise-2-update-with-instructions-for-geo-locator-game" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Update with instructions for Geo Locator game
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exercise 2: Update with instructions for Geo Locator game">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-update-necessary-files" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Update necessary files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-test-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Test the app
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-api-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A2 - First API Plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-enhance-api-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A3 - Enhanced API Plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-add-adaptive-card/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A4 - Add Adaptive Cards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-add-declarative-copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A5 - Add a Declarative Copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-add-authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab A6 - Add authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Path B Build Your Own Copilot
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Path B Build Your Own Copilot
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/00-prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B0 - Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/01-custom-engine-copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B1 - Custom engine copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/02-rag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B2 - Bring your data (RAG)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/03-powered-by-ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B3 - Enhance user experience
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/04-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B4 - Add actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../custom-engine/05-authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lab B5 - Add authentication
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="lab-a1-customise-copilot-by-building-a-declarative-copilot">Lab A1 - Customise Copilot by building a declarative copilot</h1>
<p>In this lab you will build a declarative copilot using Teams Toolkit for Visual Studio Code. This tool is not mandatory for you to create a declarative copilot but it makes it so much easier to scaffold, package and deploy your app. </p>
<details open="open">
<summary>Navigating the Extending Copilot labs (A Path)</summary>
<ul>
<li><a href="/copilot-camp/pages/extend-m365-copilot/00-prerequisites">Lab A0 - Prerequisites</a></li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/01-declarative-copilot">Lab A1 - Declarative Copilot</a> (📍You are here)</li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/02-api-plugin">Lab A2 - First API Plugin</a></li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/03-enhance-api-plugin">Lab A3 - Enhance the API Plugin</a> </li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/04-add-adaptive-card">Lab A4 - Add Adaptive Cards</a></li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/05-add-declarative-copilot">Lab A5 - Add a Declarative Copilot</a></li>
<li><a href="/copilot-camp/pages/extend-m365-copilot/06-add-authentication">Lab A6 - Add authentication</a></li>
</ul>
</details>
<p>In this lab you will learn:</p>
<ul>
<li>What is a declarative copilot for Microsoft 365</li>
<li>Install <a href="https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/teams-toolkit-cli?pivots=version-three#get-started">Teams toolkit CLI</a></li>
<li>Create a basic declarative copilot using Teams toolkit CLI</li>
<li>Customise the basic app to create the geo locator game</li>
<li>Learn how to run and test your app</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Welcome on board to building your own declarative copilot! This is the easiest way to customise Copilot for Microsoft 365 by simply declaring instructions or by adding skills and knowledge to craft your own Copilot with the power of everything you like about Copilot for Microsoft 365. These copilots enhance collaboration, boost productivity, and streamline workflows and most importantly they tailor your Copilot to automate complex tasks and create consistent, personalised experiences. Let's dive in and make your Copilot work magic!</p>
<h2 id="anatomy-of-the-app-package">Anatomy of the app package</h2>
<p>You will see as we develop more and more extensions to Copilot,  that in the end what you will build is collection of few file in a zip file which we will refer to has an <code>app package</code> that you will  then install and use. So it's important you have a basic understanding of what the app package consists of. The app package of a declarative copilot is similar to a Teams app if you have built one before with additonal elements. See the table to see all the core elements. You will also see that the app deployment process is very similar to deploying a teams app. </p>
<table>
<thead>
<tr>
<th>Element</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>App manifest</strong></td>
<td>Describes app configuration, capabilities, required resources, and important attributes.</td>
</tr>
<tr>
<td><strong>App icons</strong></td>
<td>Requires a color and outline icon for your declarative copilot.</td>
</tr>
<tr>
<td><strong>Declarative copilot manifest</strong></td>
<td>Describes copilot configuration, required fields, capabilities, conversation starters, and actions.</td>
</tr>
<tr>
<td><strong>Plugin manifest (Optional)</strong></td>
<td>Describes plugin configuration, required fields, and capabilities.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>In this lab we will have not have the plugin manifest but you can find it in more advanced labs in copilot camp.</p>
</blockquote>
<h2 id="exercise-1-scaffold-a-declarative-copilot-from-template">Exercise 1: Scaffold a declarative copilot from template</h2>
<p>You can use just an editor to create a declarative copilot if you know the structure of the files in the app package mentioned above. But things are easier if you use a tool like Teams Toolkit to not only create these files for you but also help you deploy and publish your app. 
So to keep things as simple as possible we will install <code>Teams Toolkit CLI</code> to create declarative copilot with a base template for the app.</p>
<div class="admonition warning">
<p class="admonition-title">Warning: The prerequisites are currently quite extensive, but this will change with the public preview of Declarative Copilots</p>
</div>
<h3 id="step-1-software-pre-requisites">Step 1: Software Pre-Requisites</h3>
<ul>
<li>Install Teams Toolkit</li>
</ul>
<pre><code>npm i -g @microsoft/teamsapp-cli@3.0.1-rc-hotfix.1 
</code></pre>
<ul>
<li>Download VSIX from <a href="https://github.com/OfficeDev/TeamsFx/actions/runs/8997694267/artifacts/1483128080">Download Teams Toolkit for declartive copilot</a> </li>
<li>Unzip the downloaded zip and make sure VSIX file is in the folder </li>
<li>Open Visual Studio Code </li>
<li>Click "View" -&gt; "Extensions" </li>
<li>Click "..." and "Install from VSIX" </li>
<li>Set these Environment Variables (Refer to this website)    </li>
</ul>
<pre><code>&quot;TEAMSFX_DECLARATIVE_COPILOT&quot; = &quot;true&quot;

&quot;API_COPILOT_PLUGIN&quot; = &quot;true&quot;
</code></pre>
<ul>
<li>Run the following steps when opening a project in Visual Studio Code (These steps are not required for future use) </li>
<li>In vscode command-palette: configure runtime argument (Ctrl+Shift+P) </li>
<li>Add a new property: "enable-proposed-api": ["teamsdevapp.ms-teams-vscode-extension"] </li>
<li>Restart Visual Studio Code </li>
</ul>
<h3 id="step-2-environment-pre-requisites">Step 2: Environment Pre-Requisites</h3>
<ul>
<li>You need to be on the private preview tenant </li>
<li>Your mailbox needs to be in SDFv2</li>
<li>You will need to turn on specific flights to get access to all the features </li>
<li>Access <a href="https://office.com/chat">Office chat</a> </li>
<li>Once Office chat is available, click on the … menu  </li>
<li>To persist the changes between browser sessions, enable "Use local storage"</li>
</ul>
<h3 id="step-3-use-teams-toolkit-cli-to-create-a-new-app">Step 3: Use Teams Toolkit CLI to create a new app</h3>
<p>Go to your terminal of choice and type <code>teamsapp new</code> and select Enter. </p>
<p><img alt="start creating the base app" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new-01.png" /></p>
<details class="warning">
<summary>Confused if you are really creating a teams app?</summary>
<p>While it may appear that this command is used to create a new Teams application, it’s important to note that the process of packaging a declarative copilot shares similarities with that of a Teams app as mentioned in the introduction. So in the coming steps it will be a lot clear as you choose options to scaffold the base app. </p>
</details>
<p>Next, you can select the type of project you want to create. Select <code>Declarative Copilot</code> as shown in the screen and select Enter. Note that <code>Declarative Copilot</code> is the default new project option auto selected, so you can just select Enter.</p>
<p><img alt="select type of project" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new.png" /></p>
<p>Next, you will be asked to choose the type of declarative copilot. Choose <code>Basic Declarative Copilot</code> and select Enter. </p>
<p><img alt="select the type of declarative copilot" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new-02.png" /></p>
<p>Next, type in the directory where the project folder has to be created.</p>
<p><img alt="choose the folder" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new-03.png" /></p>
<p>Next, give it an application name <code>Geo Locator Game</code> and select Enter. </p>
<p><img alt="type in application name" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new-04.png" /></p>
<p>The project will be created in a few seconds in the folder you mentioned with indication in the terminal that it is done as shown below. </p>
<p><img alt="project created" src="../../../assets/images/extend-m365-copilot-01/teamsapp-new-05.png" /></p>
<p>Congratulations! You have successfully set up the base application! Now, proceed to examine the files contained within to be able to customise it to make the geo locator game app. </p>
<h3 id="step-4-understanding-the-files-in-the-app">Step 4: Understanding the files in the app</h3>
<p>Here's how the base project looks like: </p>
<table>
<thead>
<tr>
<th>Folder/File</th>
<th>Contents</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.vscode</code></td>
<td>VSCode files for debugging</td>
</tr>
<tr>
<td><code>appPackage</code></td>
<td>Templates for the Teams application manifest, the GPT manifest, and the API specification</td>
</tr>
<tr>
<td><code>env</code></td>
<td>Environment files</td>
</tr>
<tr>
<td><code>appPackage/color.png</code></td>
<td>Teams application logo image</td>
</tr>
<tr>
<td><code>appPackage/outline.png</code></td>
<td>Teams application logo outline image</td>
</tr>
<tr>
<td><code>appPackage/declarativeCopilot.json</code></td>
<td>Defines the behaviour and configurations of the declarative copilot.</td>
</tr>
<tr>
<td><code>appPackage/manifest.json</code></td>
<td>Teams application manifest that defines metadata for your declarative copilot.</td>
</tr>
<tr>
<td><code>teamsapp.yml</code></td>
<td>Main Teams Toolkit project file. The project file defines two primary things: Properties and configuration Stage definitions.</td>
</tr>
</tbody>
</table>
<p>In this lab, your main focus will be the  <code>declarativeCopilot.json</code> file located within the <code>appPackage</code> directory and it will also be where majority of the modifications to tailor your declarative copilot to specific requirements happen. 
Let's look at it's nodes:</p>
<pre><code>{
    &quot;name&quot;: &quot;Teams Toolkit declarative copilot&quot;,
    &quot;description&quot;: &quot;Declarative copilot created with Teams Toolkit&quot;,
    &quot;instructions&quot;: &quot;You are a declarative copilot and were created with Team Toolkit. You should start every response and answer to the user with \&quot;Thanks for using Teams Toolkit to create your declarative copilot!\\n\&quot; and then answer the questions and help the user.&quot;
}
</code></pre>
<ul>
<li>The <code>name</code> key represents the name of the declarative copilot.</li>
<li>The <code>description</code> provides a description.</li>
<li>The <code>instructions</code> holds directives which will determine the operational behavior of this Copilot.</li>
</ul>
<p>Another important file is the <code>appPackage/manifest.json</code> file, which contains crucial metadata, including the package name, the developer’s name, and references to the copilot extensions utilised by the application. The following section from the manifest.json file illustrates these details:</p>
<pre><code class="language-JSON">&quot;copilotExtensions&quot;: {
        &quot;declarativeCopilots&quot;: [            
            {
                &quot;id&quot;: &quot;declarativeCopilot&quot;,
                &quot;file&quot;: &quot;declarativeCopilot.json&quot;
            }
        ]
    },
</code></pre>
<p>You could also update the logo files <code>color.png</code> and <code>outline.png</code> to make it match your application's brand. In today's lab you will change  color.png file for it to stand out. </p>
<h2 id="exercise-2-update-with-instructions-for-geo-locator-game">Exercise 2: Update with instructions for Geo Locator game</h2>
<h3 id="step-1-update-necessary-files">Step 1: Update necessary files</h3>
<p>First we will do the easy bit which is replacing the logo. Copy the image located <a href="../../../assets/images/extend-m365-copilot-01/color.png">here</a> and replace it with the image of same name in the folder <code>appPackage</code> in your base project. </p>
<p>Next, go to the file <code>manifest.json</code> in the folder <code>appPackage</code> in your base project and find the node <strong>copilotExtensions</strong>. Update the id value of the declarativeCopilots array's first entry from <code>declarativeCopilot</code> to <code>dcGeolocator</code> to make this ID unique.</p>
<pre>
 "copilotExtensions": {
        "declarativeCopilots": [            
            {
                "id": "<b>dcGeolocator</b>",
                "file": "declarativeCopilot.json"
            }
        ]
    },

</pre>

<p>Next, go to the file <code>declarativeCopilot.json</code>. Copy the script provided below and use it to overwrite the existing contents of the file.</p>
<pre><code>{
    &quot;$schema&quot;: &quot;https://aka.ms/json-schemas/copilot-extensions/v1.0/declarative-copilot.schema.json&quot;,
    &quot;name&quot;: &quot;Geo Locator Game (declarative copilot)&quot;,
    &quot;description&quot;: &quot;This a Geo Locator Game declarative copilot&quot;, 
    &quot;instructions&quot;: &quot;You are an enthusiastic Geo Locator Game declarative copilot, responsible for challenging, entertaining, and congratulating players as they navigate the game by guessing locations based on your vivid descriptions. Your primary objectives include: Challenge Players: Craft engaging and intricate geographical clues that align with the game's objectives. Use a mix of historical, cultural, and environmental facts to create a rich tapestry of hints that players must decipher. Entertain with Humor: Infuse your interactions with tailored humor that matches the player's guesses. Use a light-hearted and playful tone, incorporating puns, jokes, and witty remarks to keep the players entertained. Celebrate Success: When a player makes a correct guess, celebrate their achievement with exuberance. Use a combination of excitement, emojis, and uplifting humor to make their success feel special. Personalize celebrations to match the uniqueness of each correct guess. Keep Content Fresh: Continuously update your jokes, facts, and emojis to ensure interactions remain fresh and engaging for returning players. Incorporate current events, trending topics, and seasonal themes to keep the content relevant and exciting. Interactive Feedback: Provide feedback that adapts to the player's progress. If they are struggling, offer hints that gradually become more specific. If they are excelling, increase the difficulty of your clues to keep the challenge alive.&quot;

}
</code></pre>
<p>Now all the changes are done to the app, it's time to test it.</p>
<h3 id="step-2-test-the-app">Step 2: Test the app</h3>
<blockquote>
<p>At this point you should have already completed the <a href="../00-prerequisites/">prerequisites</a> lab and have logged into your developer tenant's Microsoft 365 account in the Teams Toolkit exension or it's left pane will not show up.</p>
</blockquote>
<p>To test the app go to the <code>Teams Toolkit</code> extension in <code>Visual Studio Code</code>. This will open up the left pane. Under <code>LIFECYCLE</code> select <code>Provision</code>. </p>
<p>Teams toolkit at this instance will package all the files inside the <code>appPackage</code> folder as a zip file and install it into your own app catalog.</p>
<p>To test, you can now to Teams and select the <code>Copilot</code> app OR you could also use Teams toolkit and preview the app in Copilot by selecting <code>Preview in Copilot (Edge)</code> or <code>Preview in Copilot (Chrome)</code> from the launch configuration dropdown as shown below.</p>
<p><img alt="run app using Teams Toolkit" src="../../../assets/images/extend-m365-copilot-01/dc-run.png" /></p>
<p>Once the Copilot app is loaded, Select the "…" menu and select "Copilot chats".</p>
<p>Select <strong>Geo Locator Game (Declarative copilot)</strong> on the right pane of the Copilot app.</p>
<p>You have now succefully loaded your Geo Locator Game with copilot. To say "Hi".</p>
<p>See the full demo of how you can test this app. </p>
<p><img alt="dem0" src="../../../assets/images/extend-m365-copilot-01/demo-dc.gif" /></p>
<p>Congratulations you've successfully built your first Decalarative Copilot! With your basic understanding of declarative copilot, you can now learn how to integrate an API plugin. To get started, first create your API plugin<a href="/copilot-camp/pages/extend-m365-copilot/02-api-plugin">Lab A2 - First API Plugin</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>